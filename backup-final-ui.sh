#!/bin/bash

echo "ðŸ“ UIç•Œé¢å®šç¨¿å¤‡ä»½è„šæœ¬"
echo "======================"
echo ""

# åˆ›å»ºå¤‡ä»½ç›®å½•
BACKUP_DIR="./ui-final-backup-$(date +%Y%m%d_%H%M%S)"
mkdir -p "$BACKUP_DIR"

echo "ðŸ”§ åˆ›å»ºå¤‡ä»½ç›®å½•: $BACKUP_DIR"
echo ""

# å¤‡ä»½æ‰€æœ‰ç›¸å…³æ–‡ä»¶
echo "ðŸ“‹ å¤‡ä»½æ–‡ä»¶åˆ—è¡¨:"
echo "---------------"

# 1. ä¸»æœåŠ¡å™¨æ–‡ä»¶
cp server-finalized-ui-complete.js "$BACKUP_DIR/"
echo "   âœ… server-finalized-ui-complete.js - ä¸»æœåŠ¡å™¨æ–‡ä»¶"

# 2. åˆ›å»ºpackage.json
cat > "$BACKUP_DIR/package.json" << 'EOF'
{
  "name": "global-best-products-finalized",
  "version": "1.0.0",
  "description": "å…¨çƒæœ€ä½³å•†å“ç™¾ç§‘å…¨ä¹¦ - UIå®šç¨¿ç‰ˆæœ¬",
  "main": "server-finalized-ui-complete.js",
  "scripts": {
    "start": "node server-finalized-ui-complete.js",
    "dev": "nodemon server-finalized-ui-complete.js"
  },
  "dependencies": {
    "express": "^4.18.2"
  },
  "devDependencies": {
    "nodemon": "^3.0.1"
  }
}
EOF
echo "   âœ… package.json - ä¾èµ–é…ç½®æ–‡ä»¶"

# 3. åˆ›å»ºå¯åŠ¨è„šæœ¬
cat > "$BACKUP_DIR/start-server.sh" << 'EOF'
#!/bin/bash

echo "ðŸš€ å¯åŠ¨å…¨çƒæœ€ä½³å•†å“ç™¾ç§‘å…¨ä¹¦ - UIå®šç¨¿ç‰ˆæœ¬"
echo "========================================"
echo ""

# å®‰è£…ä¾èµ–
if [ ! -d "node_modules" ]; then
    echo "ðŸ“¦ å®‰è£…ä¾èµ–..."
    npm install
fi

# å¯åŠ¨æœåŠ¡å™¨
echo "ðŸŒ å¯åŠ¨æœåŠ¡å™¨ (ç«¯å£ 3060)..."
node server-finalized-ui-complete.js
EOF
chmod +x "$BACKUP_DIR/start-server.sh"
echo "   âœ… start-server.sh - å¯åŠ¨è„šæœ¬"

# 4. åˆ›å»ºREADMEæ–‡æ¡£
cat > "$BACKUP_DIR/README.md" << 'EOF'
# å…¨çƒæœ€ä½³å•†å“ç™¾ç§‘å…¨ä¹¦ - UIå®šç¨¿ç‰ˆæœ¬

## ðŸ“‹ ç‰ˆæœ¬ä¿¡æ¯
- **ç‰ˆæœ¬**: æœ€ç»ˆå®šç¨¿ç‰ˆ v1.0.0
- **å¤‡ä»½æ—¶é—´**: $(date)
- **ç«¯å£**: 3060
- **å“ç±»æ•°é‡**: 245,317ä¸ª

## ðŸŽ¨ UIè®¾è®¡ç‰¹ç‚¹ï¼ˆå®šç¨¿ï¼‰
1. **æœ€ä½³è¯„é€‰ç»“æžœå•ç‹¬çº¿æ¡†** - è·Ÿè¯¦ç»†è¯„é€‰åˆ†æžåˆ†å¼€æ˜¾ç¤º
2. **è¯¦ç»†è¯„é€‰åˆ†æžæ— å¤–æ¡†** - é¿å…çº¿æ¡†å¤ªå¤šï¼Œé¡µé¢ç®€æ´
3. **è¯„è®ºåŠŸèƒ½å®Œæ•´** - è¯„è®ºè¾“å…¥å’Œå±•ç¤ºåŠŸèƒ½é½å…¨
4. **å­—ä½“å¤§å°ä¼˜åŒ–** - ç»æµŽåž‹/æ ‡å‡†åž‹/é«˜ç«¯åž‹ å’Œ è®¤å¯/ä¸è®¤å¯ å­—ä½“æ”¾å°
5. **é‡ç‚¹çªå‡ºè¯„é€‰ç†ç”±** - "è¯„é€‰é€»è¾‘"æ”¹ä¸º"è¯„é€‰ç†ç”±"ï¼Œå­—ä½“åŠ ç²—çªå‡º
6. **ç»Ÿä¸€ç°è‰²è°ƒ** - ä¸å†ä½¿ç”¨å¤šç§é¢œè‰²ï¼Œè§†è§‰ç»Ÿä¸€
7. **å“åº”å¼è®¾è®¡** - é€‚é…æ‰‹æœºã€å¹³æ¿ã€æ¡Œé¢
8. **æ¨¡å—åŒ–è®¾è®¡** - è¡¨æ ¼è‡ªåŠ¨ç”Ÿæˆï¼Œæ”¯æŒä»»æ„nÃ—nè§„æ¨¡

## ðŸš€ ç³»ç»ŸåŠŸèƒ½
1. **å®Œæ•´ç½‘ç«™æž¶æž„**
   - é¦–é¡µ: æ˜¾ç¤º245,317ä¸ªå“ç±»ç»Ÿè®¡
   - ä¸‰çº§ç›®å½•: åˆ†ç±»æµè§ˆ
   - è¯¦æƒ…é¡µ: åŠ¨æ€æ•°æ®å±•ç¤º

2. **åŠ¨æ€è¯¦æƒ…é¡µè®¿é—®**
   - âœ… æ•°æ®å·²å®Œæˆçš„å“ç±»: å¯ç‚¹å‡»è®¿é—®è¯¦æƒ…é¡µ
   - â³ æ•°æ®ç”Ÿæˆä¸­çš„å“ç±»: æ˜¾ç¤º"æ•°æ®ç”Ÿæˆä¸­"
   - âŒ æ•°æ®æœªå®Œæˆçš„å“ç±»: æ˜¾ç¤º"æ•°æ®å‡†å¤‡ä¸­"ï¼Œä¸å¯è®¿é—®

3. **å®žæ—¶ç»Ÿè®¡æ›´æ–°**
   - é¦–é¡µé¡¶éƒ¨: "245,317ä¸ªå“ç±» Â· Xæ¬¾æœ€ä½³å•†å“"
   - ç»Ÿè®¡æ•°å­—æ¯5ç§’è‡ªåŠ¨æ›´æ–°
   - æ˜¾ç¤ºå·²å®Œæˆå“ç±»æ•°é‡å’Œæœ€ä½³å•†å“æ•°é‡

## ðŸ“ æ–‡ä»¶è¯´æ˜Ž
- `server-finalized-ui-complete.js`: ä¸»æœåŠ¡å™¨æ–‡ä»¶
- `package.json`: ä¾èµ–é…ç½®æ–‡ä»¶
- `start-server.sh`: å¯åŠ¨è„šæœ¬
- `data/`: æ•°æ®åº“ç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰

## ðŸš¦ å¯åŠ¨å‘½ä»¤
```bash
# ç»™å¯åŠ¨è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™
chmod +x start-server.sh

# å¯åŠ¨æœåŠ¡å™¨
./start-server.sh

# æˆ–è€…ç›´æŽ¥ä½¿ç”¨npm
npm start
```

## ðŸ”— è®¿é—®åœ°å€
- **é¦–é¡µ**: http://localhost:3060/
- **APIç»Ÿè®¡**: http://localhost:3060/api/stats
- **å·²å®Œæˆå“ç±»è¯¦æƒ…é¡µ**:
  - http://localhost:3060/category/ä¸ªæŠ¤å¥åº·/å‰ƒé¡»ç”¨å“/ä¸€æ¬¡æ€§å‰ƒé¡»åˆ€
  - http://localhost:3060/category/å®¶å±…ç”Ÿæ´»/åŽ¨æˆ¿ç”¨å“/ä¸ç²˜é”…
  - http://localhost:3060/category/æ•°ç ç”µå­/æ‰‹æœºé…ä»¶/å……ç”µå®

## âš ï¸ é‡è¦è¯´æ˜Ž
æ­¤ç‰ˆæœ¬ä¸º**UIå®šç¨¿ç‰ˆæœ¬**ï¼Œå·²é€‚é…æ‰€æœ‰245,317ä¸ªå“ç±»è¯¦æƒ…é¡µã€‚
é™¤éžç”¨æˆ·æ˜Žç¡®è¦æ±‚ï¼Œ**ä¸å†è¿›è¡Œå¤§çš„UIä¿®æ”¹è°ƒæ•´**ã€‚

æ‰€æœ‰åŽç»­å¼€å‘ï¼ˆè‡ªåŠ¨åŒ–æ•°æ®å½•å…¥ã€ç»Ÿè®¡åŠŸèƒ½ç­‰ï¼‰éƒ½åŸºäºŽæ­¤UIæ¡†æž¶è¿›è¡Œã€‚

## ðŸ“Š å½“å‰çŠ¶æ€
- æ€»å“ç±»: 245,317ä¸ª
- å·²å®Œæˆå“ç±»: 7ä¸ª
- æœ€ä½³å•†å“æ•°é‡: 63æ¬¾
- UIçŠ¶æ€: âœ… å·²å®šç¨¿
- å¤‡ä»½çŠ¶æ€: âœ… å·²å®Œæˆ
EOF
echo "   âœ… README.md - è¯¦ç»†æ–‡æ¡£"

# 5. åˆ›å»ºæ•°æ®ç›®å½•ç»“æž„
mkdir -p "$BACKUP_DIR/data"
cat > "$BACKUP_DIR/data/README.md" << 'EOF'
# æ•°æ®åº“ç›®å½•

## æ–‡ä»¶ç»“æž„
- `categories-db.json`: å“ç±»æ•°æ®åº“ (245,317ä¸ªå“ç±»)
- `price-intervals-db.json`: ä»·æ ¼åŒºé—´æ•°æ®åº“
- `evaluation-dimensions-db.json`: è¯„æµ‹ç»´åº¦æ•°æ®åº“
- `best-products-db.json`: æœ€ä½³å•†å“æ•°æ®åº“
- `stats-db.json`: ç»Ÿè®¡æ•°æ®

## æ•°æ®åº“æž¶æž„
1. **å“ç±»æ•°æ®åº“**: å­˜å‚¨æ‰€æœ‰245,317ä¸ªå“ç±»ä¿¡æ¯
2. **ä»·æ ¼åŒºé—´æ•°æ®åº“**: å­˜å‚¨ç»æµŽåž‹ã€æ ‡å‡†åž‹ã€é«˜ç«¯åž‹ç­‰ä»·æ ¼åŒºé—´
3. **è¯„æµ‹ç»´åº¦æ•°æ®åº“**: å­˜å‚¨æ€§ä»·æ¯”æœ€é«˜ã€æœ€è€ç”¨ã€æœ€èˆ’é€‚ç­‰è¯„æµ‹ç»´åº¦
4. **æœ€ä½³å•†å“æ•°æ®åº“**: å­˜å‚¨æ¯ä¸ªå“ç±»åœ¨æ¯ä¸ªä»·æ ¼åŒºé—´å’Œè¯„æµ‹ç»´åº¦çš„æœ€ä½³å•†å“
5. **ç»Ÿè®¡æ•°æ®**: å®žæ—¶ç»Ÿè®¡ä¿¡æ¯

## è‡ªåŠ¨åŒ–æ•°æ®å½•å…¥
åŽç»­å°†å¼€å‘è‡ªåŠ¨åŒ–ç¨‹åºï¼Œ24å°æ—¶ä¸é—´æ–­ä¸ºæ‰€æœ‰å“ç±»ç”Ÿæˆæ•°æ®ã€‚
EOF
echo "   âœ… data/ ç›®å½• - æ•°æ®åº“ç»“æž„"

# 6. åˆ›å»ºæ¢å¤è„šæœ¬
cat > "$BACKUP_DIR/restore-ui.sh" << 'EOF'
#!/bin/bash

echo "ðŸ”„ æ¢å¤UIå®šç¨¿ç‰ˆæœ¬"
echo "================="
echo ""

# æ£€æŸ¥æ˜¯å¦åœ¨é¡¹ç›®ç›®å½•
if [ ! -f "server-finalized-ui-complete.js" ]; then
    echo "âŒ é”™è¯¯: è¯·åœ¨å¤‡ä»½ç›®å½•ä¸­è¿è¡Œæ­¤è„šæœ¬"
    echo "   å½“å‰ç›®å½•: $(pwd)"
    exit 1
fi

echo "âœ… æ£€æµ‹åˆ°å¤‡ä»½æ–‡ä»¶"
echo ""
echo "ðŸ“‹ æ¢å¤æ­¥éª¤:"
echo "   1. å¤åˆ¶æ‰€æœ‰æ–‡ä»¶åˆ°é¡¹ç›®æ ¹ç›®å½•"
echo "   2. å®‰è£…ä¾èµ– (å¦‚æžœéœ€è¦)"
echo "   3. å¯åŠ¨æœåŠ¡å™¨"
echo ""
echo "ðŸš€ å¯åŠ¨å‘½ä»¤: ./start-server.sh"
echo ""
echo "ðŸ”— è®¿é—®åœ°å€: http://localhost:3060/"
EOF
chmod +x "$BACKUP_DIR/restore-ui.sh"
echo "   âœ… restore-ui.sh - æ¢å¤è„šæœ¬"

echo ""
echo "ðŸŽ‰ UIç•Œé¢å®šç¨¿å¤‡ä»½å®Œæˆï¼"
echo ""
echo "ðŸ“Š å¤‡ä»½ç»Ÿè®¡:"
echo "   - æœåŠ¡å™¨æ–‡ä»¶: 1ä¸ª"
echo "   - é…ç½®æ–‡ä»¶: 1ä¸ª"
echo "   - è„šæœ¬æ–‡ä»¶: 2ä¸ª"
echo "   - æ–‡æ¡£æ–‡ä»¶: 2ä¸ª"
echo "   - æ•°æ®ç›®å½•: 1ä¸ª"
echo ""
echo "ðŸ“ å¤‡ä»½ä½ç½®: $BACKUP_DIR"
echo ""
echo "âš ï¸  é‡è¦æç¤º:"
echo "   æ­¤ç‰ˆæœ¬ä¸ºUIå®šç¨¿ç‰ˆæœ¬ï¼Œå·²é€‚é…æ‰€æœ‰245,317ä¸ªå“ç±»è¯¦æƒ…é¡µã€‚"
echo "   é™¤éžç”¨æˆ·æ˜Žç¡®è¦æ±‚ï¼Œä¸å†è¿›è¡Œå¤§çš„UIä¿®æ”¹è°ƒæ•´ã€‚"
echo ""
echo "âœ… ç¬¬ä¸€æ­¥å®Œæˆï¼å¯ä»¥å¼€å§‹åŽç»­å¼€å‘äº†ã€‚"